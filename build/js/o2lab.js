var o2lab={lib:{},html5:{}};o2lab.lib.Popup=elf.util.Class.create({constructor:function(a){elf().copy(a,this);elf().mix(this,this.constructor.option)},getModule:function(){return document.getElementById(this.moduleId)},getBackground:function(){return document.getElementById(this.backgroundId)},actNoDelay:function(g){this.showing=g;var b=this.getModule();var h=this.getBackground();var d=this.getRefer();var k=this.position;if(h){elf.dom.ClassName.toggle(h,this.backgroundShowClass,g);if(this.updateDepth&&g){elf.dom.Style.set(h,"z-index",elf.dom.Stage.getNextHighestDepth())}}if(g){var e=b.style.visibility||"";b.style.visibility="hidden";elf.dom.ClassName.add(b,this.showClass);if(k){b.style.left=k.x+"px";b.style.top=k.y+"px"}else{if(this.center){var i=d.parentNode||d;var f=i.scrollLeft||0;var a=i.scrollTop||0;var c=(i.offsetWidth-b.offsetWidth)/2+f;var j=(i.offsetHeight-b.offsetHeight)/2+a;b.style.left=c+"px";b.style.top=j+"px"}}b.style.visibility=e;this.updateDepth&&elf.dom.Style.set(b,"z-index",elf.dom.Stage.getNextHighestDepth());this.onShow&&this.onShow.call(b)}else{elf.dom.ClassName.remove(b,this.showClass);this.onHide&&this.onHide.call(b)}},showNoDelay:function(){this.actNoDelay(true)},hideNoDelay:function(){this.actNoDelay(false)},act:function(a,d){var c=this;this.showing=a;if(this.timer){clearTimeout(this.timer)}var b=elf.util.Type.isDefined(d)?d:a?this.showDelay:this.hideDelay;if(b){this.timer=setTimeout(function(){if(c.showing==a){a?c.showNoDelay():c.hideNoDelay()}},b)}else{a?this.showNoDelay():this.hideNoDelay()}},show:function(a){this.act(true,a)},hide:function(a){this.act(false,a)}});o2lab.lib.Popup.option={getRefer:function(){return document.body},hideDelay:0,showDelay:0,showing:false,updateDepth:false,showClass:"active",backgroundShowClass:"active",center:true};o2lab.lib.Dialog=elf.util.Class.create({constructor:function(a){o2lab.lib.Popup.call(this,a);var b=this;elf.dom.Event.add(this.getModule(),"click",function(c){b.hide()},function(c){return elf.dom.ClassName.has(c,b.closeButtonClass)});elf.dom.Event.add(this.getModule(),"mousedown",function(c){o2lab.lib.Draggable.start({element:b.getModule(),mouseX:c.clientX,mouseY:c.clientY})},function(c){return elf.dom.ClassName.has(c,b.handleClass)});elf.dom.Event.add(document,"mouseup",function(){o2lab.lib.Draggable.stop(b.getModule())})}},o2lab.lib.Popup);elf.util.Class.copy({closeButtonClass:"dialog-close-button",handleClass:"dialog-drag-handle"},o2lab.lib.Dialog.option);o2lab.lib.Draggable=elf.util.Class.create({});elf.util.Class.copy({UNIQUE_LABEL:elf.util.Global.guid("data-dragging-id_"),dragging:{},start:function(c){var a=true;for(var b in this.dragging){a=false}if(a){elf.dom.Event.add(document,"mousemove",this.onDragging)}if(c){var e=c.element.getAttribute(this.UNIQUE_LABEL);if(!e){e=elf.util.Global.guid();c.element.setAttribute(this.UNIQUE_LABEL,e)}var d=elf.dom.BoxModel.getPosition(c.element,document.documentElement);c.originalPosition=c.element.style.position||"";c.element.style.position="absolute";c.startX=d.x;c.startY=d.y;c.offsetX=c.mouseX-d.x;c.offsetY=c.mouseY-d.y;this.dragging[e]=c}return e},onDragging:function(a){o2lab.lib.Draggable.move(a.clientX,a.clientY)},move:function(a,f){for(var b in this.dragging){var d=this.dragging[b];var e=a-d.offsetX;var c=f-d.offsetY;d.element.style.left=e+"px";d.element.style.top=c+"px"}},stop:function(c){var e=c.getAttribute(this.UNIQUE_LABEL);var d=this.dragging[e];if(d){d.element.style.position=d.originalPosition;d.element.setAttribute(this.UNIQUE_LABEL,"");delete this.dragging[e]}var a=true;for(var b in this.dragging){a=false;break}if(a){elf.dom.Event.remove(document,"mousemove",this.onDragging)}}},o2lab.lib.Draggable);elf.util.Namespace.get("o2lab.lib.CheckGroup",window,elf.util.Class.create({constructor:function(a){var c=this;var b=this.constructor;elf.util.Class.copy(b.option,this);elf.util.Class.copy(a,this);elf.dom.Event.add(this.getWrap(),"click",function(d){c.onChange&&c.onChange(c.getValue())},function(d){return d.type==c.type})},getWrap:function(){return document.getElementById(this.wrapId)},getGroup:function(){return elf.dom.query("input[type="+this.type+"]",this.getWrap())},getChecked:function(a){return this.constructor.getChecked(this.getGroup(),a)},getValue:function(a){return this.constructor.getValue(this.getGroup(),a)},getAllValue:function(){return this.constructor.getAllValue(this.getGroup(),getDisabled)},checkByValue:function(b,a){return this.constructor.checkByValue(this.getGroup(),b,a)},checkByIndex:function(a,b){return this.constructor.checkByIndex(this.getGroup(),a,b)},checkAll:function(a){return this.constructor.checkAll(this.getGroup(),a)},checkDefault:function(){if(this.defaultCheckIndex>=0){this.checkByIndex(this.defaultCheckIndex);this.onChange&&this.onChange(this.getValue())}}}));elf.util.Class.copy({TYPE_CHECKBOX:"checkbox",TYPE_RADIO:"radio",getChecked:function(e,a){var c=[];for(var d=e.length-1;d>=0;d--){var b=e[d];if(b.checked&&(!b.disabled||a)){c.unshift(b)}}return c.length?c.length>1?c:c[0]:null},getValue:function(e,a){var d=[];for(var c=e.length-1;c>=0;c--){var b=e[c];if(b.checked&&(a||!b.disabled)&&b.value){d.unshift(b.value)}}return d.length?(d.length>1?d:d[0]):""},getAllValue:function(e,a){var d=[];for(var c=e.length-1;c>=0;c--){var b=e[c];if(a||!b.disabled){d.unshift(b.value||"")}}return d},checkByValue:function(h,g,e){var g=g instanceof Array?g:[g];var a=true;var d=0;for(var c=h.length-1;c>=0;c--){var f=false;for(var b=g.length-1;b>=0;b--){if(h[c].value==g[b]){f=true;d++;break}else{if(e){f=false}}}h[c].checked=f;if(a&&!f){a=false}}return a?-1:d},checkByIndex:function(h,c,f){var c=c instanceof Array?c:[c];var a=true;var e=0;for(var d=h.length-1;d>=0;d--){for(var b=c.length-1;b>=0;b--){var g=false;if(d==c[b]){g=true;e++}else{if(f){g=false}}h[d].checked=g;if(a&&!g){a=false}}}return a?-1:e},checkAll:function(c,a){if(this.type==this.constructor.TYPE_CHECKBOX){for(var b=c.length-1;b>=0;b--){c[b].checked=a}}}},o2lab.lib.CheckGroup);o2lab.lib.CheckGroup.option={type:o2lab.lib.CheckGroup.TYPE_CHECKBOX};o2lab.lib.Combobox=elf.util.Class.create({constructor:function(b){var c=this;this.id=b.id;this.defaultOption=b.defaultOption;var a=this.getDOM();if(b.options){this.setOption(b.options)}if(elf.util.Type.isDefined(b.defaultValue)){this.selectByValue(this.defaultValue=b.defaultValue)}if(b.onChange){this.onChange=b.onChange}a.onchange=function(d){c.onChange&&c.onChange(c.getValue())}},getDOM:function(){return document.getElementById(this.id)},getValue:function(){return this.getDOM().value},getOptionLength:function(a){return this.getDOM().options.length-(this.defaultOption&&a?0:1)},addOption:function(a){this.constructor.addOption(this.getDOM(),a)},setOption:function(a){this.defaultOption&&a.unshift(this.defaultOption);this.constructor.setOption(this.getDOM(),a)},selectByValue:function(a){this.constructor.selectByValue(this.getDOM(),a)},selectByIndex:function(a){this.constructor.selectByIndex(this.getDOM(),a)},selectByText:function(a){this.constructor.selectByText(this.getDOM(),a)},disable:function(a){this.constructor.disable(this.getDOM(),a)},selectDefault:function(){var a=false;switch(true){case this.defaultSelectIndex>=0:this.selectByIndex(this.defaultSelectIndex);a=true;break;case elf.util.Type.isDefined(this.defaultValue):this.selectByValue(this.defaultValue);a=true;break;default:break}if(a){this.onChange&&this.onChange(this.getValue())}}});elf().copy({addOption:function(b,c){var a=b.options.length;var d=(b.options[a]=new Option(c.text,c.value));if(c.selected){d.selected=true}},setOption:function(b,c){b.options.length=0;for(var d=0,a=c.length;d<a;d++){this.addOption(b,c[d])}b=null},selectByValue:function(a,c){for(var b=a.firstChild;b;b=b.nextSibling){if(b.nodeType==1&&b.value==c){b.selected=true}}},selectByIndex:function(a,b){var c=a.options[b];if(c){c.selected=true}},selectByText:function(a,d){var c=a.options;for(var b=c.length-1;b>=0;b--){c[b].selected=c[b].innerHTML==d}},disable:function(c,a){c.disabled=!elf.util.Type.isUndefined(a)?a:!c.disabled}},o2lab.lib.Combobox);o2lab.lib.TabSwitch=elf.util.Class.create({constructor:function(b){var f=this;elf.util.Class.copy(this.constructor.option,this);elf.util.Class.copy(b,this);var e=this.getTabGroup();var d=this.getContentGroup();var a=elf.util.Type.isDefined(this.defaultOn)&&this.defaultOn!=-1;for(var c=e.length-1;c>=0;c--){e[c].setAttribute(this.tabClass,c);d[c].setAttribute(this.contentClass,c);if(a){elf.dom.ClassName.remove(e[c],this.tabOnClass);elf.dom.ClassName.remove(d[c],this.contentActiveClass)}}elf.dom.Event.add(this.getWrap(),this.activeEvent,function(h){var g=f.getCurrentTab();if(this!=g){f.switchTo(this);if(f.onSwitchTab){f.onSwitchTab()}}},function(g){return elf.dom.ClassName.has(g,f.tabClass)});if(a&&e.length&&d.length){elf.dom.ClassName.add(e[this.defaultOn],this.tabOnClass);elf.dom.ClassName.add(d[this.defaultOn],this.contentActiveClass);if(f.onSwitchTab){f.onSwitchTab()}}},getWrap:function(){return document.getElementById(this.wrapId)},getElementsByClassName:function(a){return elf.dom.Selector.queryAll("."+a.replace(/ +/g,"."),this.getWrap())},getTabGroup:function(){return this.getElementsByClassName(this.tabClass)},getContentGroup:function(){return this.getElementsByClassName(this.contentClass)},getCurrentIndex:function(){return parseInt(this.getCurrentTab().getAttribute(this.tabClass))},getCurrentTab:function(){var a=this.getElementsByClassName(this.tabClass+"."+this.tabOnClass);return a.length?a[0]:null},getCurrentContent:function(){var a=this.getElementsByClassName(this.contentClass+"."+this.contentActiveClass);return a.length?a[0]:null},switchTo:function(c){var b=this.getCurrentTab();var d=this.getCurrentContent();if(b){elf.dom.ClassName.remove(b,this.tabOnClass)}if(d){elf.dom.ClassName.remove(d,this.contentActiveClass)}elf.dom.ClassName.add(c,this.tabOnClass);var a=c.getAttribute(this.tabClass);d=elf.dom.Selector.queryAll("#"+this.wrapId+" ."+this.contentClass+"["+this.contentClass+"="+a+"]")[0];elf.dom.ClassName.add(d,this.contentActiveClass)},switchByIndex:function(a){this.switchTo(this.getTabGroup()[a])}});o2lab.lib.TabSwitch.option={tabClass:"tab-switch",tabOnClass:"on",contentClass:"tab-content",contentActiveClass:"active",defaultOn:0,activeEvent:"click"};o2lab.lib.AjaxForm=elf.util.Class.create({constructor:function(a){var c=this;elf().copy(a,this);var b=this.getForm();b.onsubmit=function(){return c.submitForm()};b.onreset=function(){return c.onReset&&c.onReset()}},getForm:function(){return document.getElementById(this.formId)},getFormData:function(){return this.constructor.getFormData(this.getForm())},setFormData:function(b,a){this.constructor.setFormData(this.getForm(),b,a)},handleFieldError:function(a){this.constructor.handleFieldError(a)},resetFormError:function(){this.constructor.resetFormError(this.getForm())},submitForm:function(){var c=this;this.resetFormError();var b=false;if(this.validate?this.validate():true){b=true}else{b=false}if(b){this.resetFormError();var a=this.getForm();var d=this.getFormData();elf.net.Ajax.load({url:a.action,method:a.method||elf.net.Ajax.HTTP_POST,responseType:elf.net.Ajax.DATA_TYPE_JSON,data:d,onsuccess:function(e){if(e.fieldError){c.handleFieldError(e.fieldError)}else{c.onSubmitSuccess&&c.onSubmitSuccess(e)}}})}return false}});elf.util.Class.copy({getFormData:function(e,d){var g=new elf.net.URLParameter();var f=e.elements;for(var c=0,a=f.length;c<a;c++){var b=f[c];g.add(this.getFieldData(b,d))}return g},getFieldData:function(g,c){if(elf.util.Type.isFunction(c)){return c(g)}var d=new elf.net.URLParameter();var i=g.name;var b=g.value;if(!g.disabled&&i){switch(g.type){case"radio":if(!g.checked){break}case"textarea":case"text":case"password":case"hidden":case"select-one":d.set(i,b);break;case"checkbox":if(g.checked){d.add(i,b)}break;case"select-multiple":var a=g.options;var f=a.length;for(var h=0;h<f;h++){var e=a[h];if(e.selected){d.add(i,e.value)}}break}}return d},setFormData:function(e,f,d){for(var c in f){var b=e.elements[c];if(b){if(b.length&&b.nodeType!=1){for(var a=b.length-1;a>=0;a--){this.setFieldValue(b[a],f[c],d)}}else{this.setFieldValue(b,f[c],d)}}}},setFieldValue:function(g,k,c){if(elf.util.Type.isFunction(c)){return c(g,k)}var g=this.getField(g);var k=elf.util.Type.isNull(k)||k=="null"?"":k;if(k!=g.value&&g.length){for(var d=g.length-1;d>=0;d--){var h=g[d];var b=h.value;switch(h.type){case"radio":case"checkbox":h.checked=k==b;break;case"textarea":case"text":case"password":case"hidden":h.value=k;break;case"select-one":o2lab.lib.Combobox.selectByValue(h,k);break;case"select-multiple":var a=h.options;var f=a.length;for(var j=0;j<f;j++){var e=a[j];a[j].selected=e.value==k}break}}}},getField:function(a){return elf.util.Type.isString(a)?document.getElementsByName(a):a instanceof Array?a:[a]},getFieldInfoBlock:function(e){var c=[];var a=this.getField(e);var g=false;for(var d=a.length-1;d>=0;d--){for(var f=a[d].parentNode;f;f=f.parentNode){if(elf.dom.ClassName.has(f,"input-bar")){g=true;break}}if(g){c.push(f)}}for(var d=c.length-1;d>=0;d--){for(var b=d-1;b>=0;b--){if(c[b]==c[d]){c.splice(d,1)}}}return c},handleFieldError:function(e){var d=e;if(elf.util.Type.isObject(e)&&!(e instanceof Array)){d=[];for(var b in e){d.push({field:b,error:e[b]})}}for(var b=0,a=d.length;b<a;b++){var c=d[b];this.setFieldError(c.field,c.error)}},setFieldInfo:function(g,b,f){var h=this.getFieldInfoBlock(g);var e=elf.util.Type.isDefined(f)?f instanceof Array?f.join("<br />"):f+"":"";for(var a=h.length-1;a>=0;a--){var d=elf.dom.query("."+b,h[a])[0];if(d){d.innerHTML=e}var c=h[a].getAttribute("status");c&&elf.dom.ClassName.remove(h[a],c);if(e){elf.dom.ClassName.add(h[a],b);h[a].setAttribute("status",b)}}},setFieldError:function(b,a){this.setFieldInfo(b,this.INFO_TYPE_ERROR,a)},setFieldSuccess:function(b,a){this.setFieldInfo(b,this.INFO_TYPE_SUCCESS,a)},resetFormError:function(b){for(var a=b.elements.length-1;a>=0;a--){this.setFieldError(b.elements[a],[])}},disableFieldSet:function(d,c){var a=elf.dom.query("input",d).concat(elf.dom.query("select",d)).concat(elf.dom.query("textarea",d));for(var b=a.length-1;b>=0;b--){a[b].disabled=c}},disableField:function(c,b){var c=elf.util.Type.isString(c)?document.getElementsByName(c):c instanceof Array?c:[c];for(var a=c.length-1;a>=0;a--){c[a].disabled=b}},setErrorFieldFocus:function(d){if(d.length){var a=this.getField(d[0].field);for(var c=a.length-1;c>=0;c--){var b=a[c];if(elf.dom.isVisible(b)&&b.type!="hidden"){b.focus()}}}},INFO_TYPE_HINT:"hint",INFO_TYPE_ERROR:"error",INFO_TYPE_SUCCESS:"success"},o2lab.lib.AjaxForm);o2lab.html5.Form={validateField:function(a){return a.checkValidity?a.checkValidity():true}};