var o2lab={lib:{},html5:{}};o2lab.lib.Popup=elf.util.Class.create({constructor:function(a){elf.util.Class.copy(a,this);elf.util.Class.extend(this,this.constructor.option)},getModule:function(){return document.getElementById(this.moduleId)},getBackground:function(){return document.getElementById(this.backgroundId)},actNoDelay:function(a){this.showing=a;var b=this.getModule(),d=this.getBackground(),f=this.getRefer(),e=this.position;if(d){elf.dom.ClassName.toggle(d,this.backgroundShowClass,a);this.updateDepth&&a&&elf.dom.Style.set(d,"z-index",elf.dom.Stage.getNextHighestDepth())}if(a){var k=b.style.visibility||"";b.style.visibility="hidden";elf.dom.ClassName.add(b,this.showClass);if(e){b.style.left=e.x+"px";b.style.top=e.y+"px"}else if(this.center){var c=f.parentNode||f,h=c.scrollLeft||0,i=c.scrollTop||0,g=(c.offsetWidth-b.offsetWidth)/2+h,j=(c.offsetHeight-b.offsetHeight)/2+i;b.style.left=g+"px";b.style.top=j+"px"}b.style.visibility=k;this.updateDepth&&elf.dom.Style.set(b,"z-index",elf.dom.Stage.getNextHighestDepth());this.onShow&&this.onShow.call(b)}else{elf.dom.ClassName.remove(b,this.showClass);this.onHide&&this.onHide.call(b)}},showNoDelay:function(){this.actNoDelay(true)},hideNoDelay:function(){this.actNoDelay(false)},act:function(a,b){var c=this;this.showing=a;this.timer&&clearTimeout(this.timer);var d=elf.util.Type.isDefined(b)?b:a?this.showDelay:this.hideDelay;d?(this.timer=setTimeout(function(){c.showing==a&&(a?c.showNoDelay():c.hideNoDelay())},d)):a?this.showNoDelay():this.hideNoDelay()},show:function(a){this.act(true,a)},hide:function(a){this.act(false,a)}});o2lab.lib.Popup.option={getRefer:function(){return document.body},hideDelay:0,showDelay:0,showing:false,updateDepth:false,showClass:"active",backgroundShowClass:"active",center:true};o2lab.lib.Dialog=elf.util.Class.create({constructor:function(a){this.superClass.call(this,a);var b=this;elf.dom.Event.add(this.getModule(),"click",function(a){b.hide()},function(a){return elf.dom.ClassName.has(a,b.closeButtonClass)});elf.dom.Event.add(this.getModule(),"mousedown",function(a){o2lab.lib.Draggable.start({element:b.getModule(),mouseX:a.clientX,mouseY:a.clientY})},function(a){return elf.dom.ClassName.has(a,b.handleClass)});elf.dom.Event.add(document,"mouseup",function(){o2lab.lib.Draggable.stop(b.getModule())})}},o2lab.lib.Popup);elf.util.Class.copy({closeButtonClass:"dialog-close-button",handleClass:"dialog-drag-handle"},o2lab.lib.Dialog.option);o2lab.lib.Draggable=elf.util.Class.create({});elf.util.Class.copy({UNIQUE_LABEL:elf.util.Global.guid("data-dragging-id_"),dragging:{},start:function(a){var d=true;for(var e in this.dragging)d=false;d&&elf.dom.Event.add(document,"mousemove",this.onDragging);if(a){var b=a.element.getAttribute(this.UNIQUE_LABEL);if(!b){b=elf.util.Global.guid();a.element.setAttribute(this.UNIQUE_LABEL,b)}var c=elf.dom.BoxModel.getPosition(a.element,document.documentElement);a.originalPosition=a.element.style.position||"";a.element.style.position="absolute";a.startX=c.x;a.startY=c.y;a.offsetX=a.mouseX-c.x;a.offsetY=a.mouseY-c.y;this.dragging[b]=a}return b},onDragging:function(a){o2lab.lib.Draggable.move(a.clientX,a.clientY)},move:function(a,b){for(var d in this.dragging){var c=this.dragging[d],e=a-c.offsetX,f=b-c.offsetY;c.element.style.left=e+"px";c.element.style.top=f+"px"}},stop:function(a){var c=a.getAttribute(this.UNIQUE_LABEL),b=this.dragging[c];if(b){b.element.style.position=b.originalPosition;b.element.setAttribute(this.UNIQUE_LABEL,"");delete this.dragging[c]}var d=true;for(var e in this.dragging){d=false;break}d&&elf.dom.Event.remove(document,"mousemove",this.onDragging)}},o2lab.lib.Draggable);elf.util.Namespace.get("o2lab.lib.CheckGroup",window,elf.util.Class.create({constructor:function(a){var b=this,c=this.constructor;elf.util.Class.copy(c.option,this);elf.util.Class.copy(a,this);elf.dom.Event.add(this.getWrap(),"click",function(a){b.onChange&&b.onChange(b.getValue())},function(a){return a.type==b.type})},getWrap:function(){return document.getElementById(this.wrapId)},getGroup:function(){return elf.dom.query("input[type="+this.type+"]",this.getWrap())},getChecked:function(a){return this.constructor.getChecked(this.getGroup(),a)},getValue:function(a){return this.constructor.getValue(this.getGroup(),a)},getAllValue:function(){return this.constructor.getAllValue(this.getGroup(),getDisabled)},checkByValue:function(a,b){return this.constructor.checkByValue(this.getGroup(),a,b)},checkByIndex:function(a,b){return this.constructor.checkByIndex(this.getGroup(),a,b)},checkAll:function(a){return this.constructor.checkAll(this.getGroup(),a)},checkDefault:function(){if(this.defaultCheckIndex>=0){this.checkByIndex(this.defaultCheckIndex);this.onChange&&this.onChange(this.getValue())}}}));elf.util.Class.copy({TYPE_CHECKBOX:"checkbox",TYPE_RADIO:"radio",getChecked:function(a,b){var c=[];for(var e=a.length-1;e>=0;e--){var d=a[e];d.checked&&(!d.disabled||b)&&c.unshift(d)}return c.length?c.length>1?c:c[0]:null},getValue:function(a,b){var c=[];for(var e=a.length-1;e>=0;e--){var d=a[e];d.checked&&(b||!d.disabled)&&d.value&&c.unshift(d.value)}return c.length?c.length>1?c:c[0]:""},getAllValue:function(a,b){var e=[];for(var c=a.length-1;c>=0;c--){var d=a[c];(b||!d.disabled)&&e.unshift(d.value||"")}return e},checkByValue:function(a,b,c){var b=b instanceof Array?b:[b],f=true,h=0;for(var e=a.length-1;e>=0;e--){var d=false;for(var g=b.length-1;g>=0;g--)if(a[e].value==b[g]){d=true;h++;break}else c&&(d=false);a[e].checked=d;f&&!d&&(f=false)}return f?-1:h},checkByIndex:function(a,b,c){var b=b instanceof Array?b:[b],f=true,h=0;for(var e=a.length-1;e>=0;e--)for(var g=b.length-1;g>=0;g--){var d=false;if(e==b[g]){d=true;h++}else c&&(d=false);a[e].checked=d;f&&!d&&(f=false)}return f?-1:h},checkAll:function(a,b){if(this.type==this.constructor.TYPE_CHECKBOX)for(var c=a.length-1;c>=0;c--)a[c].checked=b}},o2lab.lib.CheckGroup);o2lab.lib.CheckGroup.option={type:o2lab.lib.CheckGroup.TYPE_CHECKBOX};o2lab.lib.Combobox=elf.util.Class.create({constructor:function(a){var b=this;this.id=a.id;this.defaultOption=a.defaultOption;var c=this.getDOM();a.options&&this.setOption(a.options);elf.util.Type.isDefined(a.defaultValue)&&this.selectByValue(this.defaultValue=a.defaultValue);a.onChange&&(this.onChange=a.onChange);c.onchange=function(a){b.onChange&&b.onChange(b.getValue())}},getDOM:function(){return document.getElementById(this.id)},getValue:function(){return this.getDOM().value},getOptionLength:function(a){return this.getDOM().options.length-(this.defaultOption&&a?0:1)},addOption:function(a){this.constructor.addOption(this.getDOM(),a)},setOption:function(a){this.defaultOption&&a.unshift(this.defaultOption);this.constructor.setOption(this.getDOM(),a)},selectByValue:function(a){this.constructor.selectByValue(this.getDOM(),a)},selectByIndex:function(a){this.constructor.selectByIndex(this.getDOM(),a)},selectByText:function(a){this.constructor.selectByText(this.getDOM(),a)},disable:function(a){this.constructor.disable(this.getDOM(),a)},selectDefault:function(){var a=false;switch(true){case this.defaultSelectIndex>=0:this.selectByIndex(this.defaultSelectIndex);a=true;break;case elf.util.Type.isDefined(this.defaultValue):this.selectByValue(this.defaultValue);a=true;break;default:break}a&&this.onChange&&this.onChange(this.getValue())}});elf.util.Class.extend(o2lab.lib.Combobox,{addOption:function(a,b){var c=a.options.length,d=a.options[c]=new Option(b.text,b.value);b.selected&&(d.selected=true)},setOption:function(a,b){a.options.length=0;for(var c=0,d=b.length;c<d;c++)this.addOption(a,b[c]);a=null},selectByValue:function(a,b){for(var c=a.firstChild;c;c=c.nextSibling)c.nodeType==1&&c.value==b&&(c.selected=true)},selectByIndex:function(a,b){var c=a.options[b];c&&(c.selected=true)},selectByText:function(a,b){var d=a.options;for(var c=d.length-1;c>=0;c--)d[c].selected=d[c].innerHTML==b},disable:function(a,b){a.disabled=!elf.util.Type.isUndefined(b)?b:!a.disabled}});o2lab.lib.TabSwitch=elf.util.Class.create({constructor:function(a){var c=this;elf.util.Class.copy(this.constructor.option,this);elf.util.Class.copy(a,this);var d=this.getTabGroup(),e=this.getContentGroup(),f=elf.util.Type.isDefined(this.defaultOn)&&this.defaultOn!=-1;for(var b=d.length-1;b>=0;b--){d[b].setAttribute(this.tabClass,b);e[b].setAttribute(this.contentClass,b);if(f){elf.dom.ClassName.remove(d[b],this.tabOnClass);elf.dom.ClassName.remove(e[b],this.contentActiveClass)}}elf.dom.Event.add(this.getWrap(),this.activeEvent,function(a){var b=c.getCurrentTab();if(this!=b){c.switchTo(this);c.onSwitchTab&&c.onSwitchTab()}},function(a){return elf.dom.ClassName.has(a,c.tabClass)});if(f&&d.length&&e.length){elf.dom.ClassName.add(d[this.defaultOn],this.tabOnClass);elf.dom.ClassName.add(e[this.defaultOn],this.contentActiveClass);c.onSwitchTab&&c.onSwitchTab()}},getWrap:function(){return document.getElementById(this.wrapId)},getElementsByClassName:function(a){return elf.dom.Selector.queryAll("."+a.replace(/ +/g,"."),this.getWrap())},getTabGroup:function(){return this.getElementsByClassName(this.tabClass)},getContentGroup:function(){return this.getElementsByClassName(this.contentClass)},getCurrentIndex:function(){return parseInt(this.getCurrentTab().getAttribute(this.tabClass))},getCurrentTab:function(){var a=this.getElementsByClassName(this.tabClass+"."+this.tabOnClass);return a.length?a[0]:null},getCurrentContent:function(){var a=this.getElementsByClassName(this.contentClass+"."+this.contentActiveClass);return a.length?a[0]:null},switchTo:function(a){var c=this.getCurrentTab(),b=this.getCurrentContent();c&&elf.dom.ClassName.remove(c,this.tabOnClass);b&&elf.dom.ClassName.remove(b,this.contentActiveClass);elf.dom.ClassName.add(a,this.tabOnClass);var d=a.getAttribute(this.tabClass);b=elf.dom.Selector.queryAll("#"+this.wrapId+" ."+this.contentClass+"["+this.contentClass+"="+d+"]")[0];elf.dom.ClassName.add(b,this.contentActiveClass)},switchByIndex:function(a){this.switchTo(this.getTabGroup()[a])}});o2lab.lib.TabSwitch.option={tabClass:"tab-switch",tabOnClass:"on",contentClass:"tab-content",contentActiveClass:"active",defaultOn:0,activeEvent:"click"};o2lab.lib.AjaxForm=elf.util.Class.create({constructor:function(a){var b=this;elf.util.Class.extend(this,a);var c=this.getForm();c.onsubmit=function(){return b.submitForm()};c.onreset=function(){return b.onReset&&b.onReset()}},getForm:function(){return document.getElementById(this.formId)},getFormData:function(){return this.constructor.getFormData(this.getForm())},setFormData:function(a,b){this.constructor.setFormData(this.getForm(),a,b)},handleFieldError:function(a){this.constructor.handleFieldError(a)},resetFormError:function(){this.constructor.resetFormError(this.getForm())},submitForm:function(){var a=this;this.resetFormError();var b=false;(this.validate?this.validate():true)?(b=true):b=false;if(b){this.resetFormError();var c=this.getForm(),d=this.getFormData();elf.net.Ajax.load({url:c.action,method:c.method||elf.net.Ajax.HTTP_POST,responseType:elf.net.Ajax.DATA_TYPE_JSON,data:d,onSuccess:function(b){b.fieldError?a.handleFieldError(b.fieldError):a.onSubmitSuccess&&a.onSubmitSuccess(b)}})}return false}});elf.util.Class.copy({getFormData:function(a,b){var d=new elf.net.URLParameter(),e=a.elements;for(var c=0,g=e.length;c<g;c++){var f=e[c];d.add(this.getFieldData(f,b))}return d},getFieldData:function(a,b){if(elf.util.Type.isFunction(b))return b(a);var c=new elf.net.URLParameter(),d=a.name,f=a.value;if(!a.disabled&&d)switch(a.type){case"radio":if(!a.checked)break;case"textarea":case"text":case"password":case"hidden":case"select-one":c.set(d,f);break;case"checkbox":a.checked&&c.add(d,f);break;case"select-multiple":var h=a.options,i=h.length;for(var e=0;e<i;e++){var g=h[e];g.selected&&c.add(d,g.value)}}return c},setFormData:function(a,b,c){for(var e in b){var d=a.elements[e];if(d)if(d.length&&d.nodeType!=1)for(var f=d.length-1;f>=0;f--)this.setFieldValue(d[f],b[e],c);else this.setFieldValue(d,b[e],c)}},setFieldValue:function(a,b,c){if(elf.util.Type.isFunction(c))return c(a,b);var a=this.getField(a),b=elf.util.Type.isNull(b)||b=="null"?"":b;if(b!=a.value&&a.length)for(var f=a.length-1;f>=0;f--){var d=a[f],h=d.value;switch(d.type){case"radio":case"checkbox":d.checked=b==h;break;case"textarea":case"text":case"password":case"hidden":d.value=b;break;case"select-one":o2lab.lib.Combobox.selectByValue(d,b);break;case"select-multiple":var g=d.options,j=g.length;for(var e=0;e<j;e++){var i=g[e];g[e].selected=i.value==b}}}},getField:function(a){return elf.util.Type.isString(a)?document.getElementsByName(a):a instanceof Array?a:[a]},getFieldInfoBlock:function(a){var c=[],g=this.getField(a),f=false;for(var b=g.length-1;b>=0;b--){for(var d=g[b].parentNode;d;d=d.parentNode)if(elf.dom.ClassName.has(d,"input-bar")){f=true;break}f&&c.push(d)}for(var b=c.length-1;b>=0;b--)for(var e=b-1;e>=0;e--)c[e]==c[b]&&c.splice(b,1);return c},handleFieldError:function(a){var c=a;if(elf.util.Type.isObject(a)&&!(a instanceof Array)){c=[];for(var b in a)c.push({field:b,error:a[b]})}for(var b=0,e=c.length;b<e;b++){var d=c[b];this.setFieldError(d.field,d.error)}},setFieldInfo:function(a,b,c){var e=this.getFieldInfoBlock(a),g=elf.util.Type.isDefined(c)?c instanceof Array?c.join("<br />"):c+"":"";for(var d=e.length-1;d>=0;d--){var f=elf.dom.query("."+b,e[d])[0];f&&(f.innerHTML=g);var h=e[d].getAttribute("status");h&&elf.dom.ClassName.remove(e[d],h);if(g){elf.dom.ClassName.add(e[d],b);e[d].setAttribute("status",b)}}},setFieldError:function(a,b){this.setFieldInfo(a,this.INFO_TYPE_ERROR,b)},setFieldSuccess:function(a,b){this.setFieldInfo(a,this.INFO_TYPE_SUCCESS,b)},resetFormError:function(a){for(var b=a.elements.length-1;b>=0;b--)this.setFieldError(a.elements[b],[])},disableFieldSet:function(a,b){var d=elf.dom.query("input",a).concat(elf.dom.query("select",a)).concat(elf.dom.query("textarea",a));for(var c=d.length-1;c>=0;c--)d[c].disabled=b},disableField:function(a,b){var a=elf.util.Type.isString(a)?document.getElementsByName(a):a instanceof Array?a:[a];for(var c=a.length-1;c>=0;c--)a[c].disabled=b},setErrorFieldFocus:function(a){if(a.length){var d=this.getField(a[0].field);for(var c=d.length-1;c>=0;c--){var b=d[c];elf.dom.isVisible(b)&&b.type!="hidden"&&b.focus()}}},INFO_TYPE_HINT:"hint",INFO_TYPE_ERROR:"error",INFO_TYPE_SUCCESS:"success"},o2lab.lib.AjaxForm);o2lab.html5.Form={validateField:function(a){return a.checkValidity?a.checkValidity():true}}